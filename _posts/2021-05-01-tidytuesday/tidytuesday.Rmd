---
title: "Tidytuesday-Videogames"
description: |
  Tidytuesday videogame graph.
author:
  - name: Demetrio Munoz 
    url: {}
date: 05-01-2021
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Load data & assign object to data
```{r}

games <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-16/games.csv')
```


```
install.packages(tidytuesday)
install.packages(tidyverse)
```
# Load packages 
```{r}
library(tidytuesdayR)
library(tidyverse)
library(scales)
library(lubridate)
library(plotly)
theme_set(theme_light())
```

# Load Data
```{r}
tt<- tt_load("2021-03-16")

```
 1 because every first of the month
```{r}
tibble(date = seq(as.Date("2020-01-01"),as.Date("2020-12-31"),1)) %>% 
  mutate(month_number = month(date))



games<-tt$games %>% 
  mutate(avg_peak_perc = parse_number(avg_peak_perc)/100) %>%
  mutate(date = ymd(paste(year,month,1))) %>%
  filter(date > min(date)) %>%
  mutate(month = fct_reorder(month,month(date)))
         
```


# working with the variable year recreate the variable to be more vizual. Turning month into number

```
this graph shows the number of games tracked in that year
games %>% 
  count(date) %>% 
  ggplot(aes(date,n)) + 
  geom_col()
```
This tracks games over time
```{r}
games %>% 
  count(date) %>% 
  ggplot(aes(date,n)) + 
  geom_col()

summarize_games <- function(tbl) {
  tbl %>%
    summarize(median_avg = median(avg),
              median_peak = median(peak))
}

# average number of players at any point
games %>% 
  group_by(date) %>% 
  ggplot(aes(date, median_avg)) +
  geom_line() + 
  expand_limits(y = 0) + 
  labs(x = "Month",
       y = "Median Popularity of game on steam")
  

# Spikes during summer, slow during school year
games %>% 
  filter(date< "2020-01-01") %>% 
  group_by(month) %>%
  summarize_games() %>%
  ggplot(aes(month, median_avg)) + 
  geom_line(group = 1) + 
  expand_limits(y = 0) + 
  labs(x = "Month of year",
       y= "Mediian popularity of a game on steam", 
       title = "Seasonal trend in steam games",
       subtitle = "From 2012 - 2019")

games %>% 
  group_by(year, month) %>% 
  summarize_games() %>%
  ggplot(aes(month, median_avg)) + 
  geom_line(aes(color = factor(year), group = year)) + 
  expand_limits(y = 0) + 
  labs(x = "Month of year",
       y= "Mediian popularity of a game on steam", 
       title = "Seasonal trend in steam games",
       color = "Year")


games %>% 
  group_by(date) %>%
  summarize_games() %>%
  ggplot(aes(date,median_peak)) + 
  geom_line() + 
  expand_limits(y = 0)
```

Distrubution of game popularity

```{r}
games %>%
  filter(date == max(date)) %>% 
  ggplot(aes(avg)) + 
  geom_histogram() + 
  scale_x_log10(labels=comma, 
                breaks=10 ^ seq(1,5)) + 
  labs(x = "Average number of players across Feb 2021")
games %>%
  filter(avg >= 100) %>%
  filter(date == max(date)) %>% 
  ggplot(aes(avg_peak_perc)) + 
  geom_histogram() 
games %>%
  filter(avg >= 100) %>%
  filter(date == max(date))%>%
  arrange((avg_peak_perc))
# On this graph you can tell that world of warship stands out.
games %>% 
  filter(avg >= 1000) %>%
  filter(date == "2021-01-01")%>%
  arrange((avg_peak_perc)) %>%
  ggplot(aes(avg, 1 / avg_peak_perc,label = gamename)) + 
  geom_point() + 
  geom_text(vjust = 1,hjust = 1,check_overlap = TRUE) +
  scale_y_log10() + 
  scale_x_log10(labels =comma) + 
  labs(x= "Average number of players in Feb 2021",
       y = "Ratio of Peak / Average")
games %>%
  filter(date == max(date)) %>% 
  arrange(desc(avg)) %>%
  
```


spike on december 2019 
the different spikes show when a new game came out and was poular.

# The tidy Tuesday data that I will be working with is Video games. The data is about video games it comes from steam by way of kaggle and originally came from Steam Charts.

Loading games into mydata object 
```{r}
mydata <- (games)

mydata$gamename <- (mydata$gamename)

mydata$year<- (mydata$year)
mydata$peak<- (mydata$peak)
print(mydata$peak)
head(mydata$peak)

df_gamename_avg <-mydata %>% 
  select(gamename,avg) %>%
  data.frame()
print(df_gamename_avg)
barplot(df_gamename_avg$avg, col = blues9)
df
```

```
created data frame to work on the 
```


```{r}
vis <- mydata %>% 
  select(year, peak) %>%
  ggplot(aes(x = year, 
             y = peak)) + geom_point()  
vis


vis2 <- mydata %>% 
select(gamename) %>% 
  ggplot(aes(x=gamename, color = "blue")) + geom_bar()
vis2


hist(mydata$year, breaks = 10, col = "red", main = "Histogram of peaks", xlab = "Height Bin")



mydata_geom <- mydata %>%
  ggplot(aes(avg,peak)) +
  abline(lm(peak~1,avg, col = "blue",lwd =2))

attach(mydata) %>%  plot(avg, peak)
  abline(lm(peak ~ avg), col = "blue", lwd = 2)
#vizc <- mydata %>% select(mydata$peak) %>%  na.omit() %>% ggplot(a
 # es(x=peak, fill=peak)) +  geom_histogram() + guides(fill=FALSE) + labs(title = "class standing & number of respondents ",
       #x = "Class Standing",
       #y = "number of respondents")
```

 skill based nier,nier, god of war all , gravity rush,persona 5, dark souls 3, bioshock infinite, monster hunter,  battlefield 1, tekken, blaze blue, dead space

